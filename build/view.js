(()=>{function e(e,t){e.dataset.opened||(e.showModal(),e.dataset.opened=!0,t.openLimitId&&(localStorage.setItem(t.openCountId,parseInt(t.openCount)+1),localStorage.setItem(t.lastOpenedId,Date.now())))}window.onload=t=>{document.querySelectorAll(".wp-block-emma-dialog").forEach((t=>{var o=JSON.parse(t.dataset.options);if(""!==o.openLinkAddress&&document.querySelectorAll("[href='"+o.openLinkAddress+"']").forEach((e=>{e.addEventListener("click",(function(e){var n=window.innerWidth;"desktop"===o.openOn&&n<=600||"mobile"===o.openOn&&n>600||(e.preventDefault(),t.showModal(),t.dataset.opened=!0)}))})),o.openAutomatically&&!localStorage.getItem(o.openLimitId+"-preventautoopen")){var n=window.innerWidth;if(!("desktop"===o.openOn&&n<=600||"mobile"===o.openOn&&n>600)){var a=document.querySelector("body").classList.contains("logged-in");if(!(a&&"logged-out"===o.openUsers||!a&&"logged-in"===o.openUsers)){if(o.openLimit){o.lastOpenedId=o.openLimitId+"-lastopened",o.openCountId=o.openLimitId+"-opencount";var i=localStorage.getItem(o.lastOpenedId)||0,d=o.openLimitExpiration;if(d>0&&Date.now()-86400*d>i&&localStorage.setItem(o.openCountId,0),o.openCount=localStorage.getItem(o.openCountId)||0,o.openCount>=o.openLimit)return}if("delay"===o.openAutomatically&&setTimeout((function(){e(t,o)}),1e3*o.openDelay),"exit"===o.openAutomatically){document.addEventListener("mouseout",(function(n){n.toElement||n.relatedTarget||e(t,o)})),document.addEventListener("touchstart",(function(){document.body.classList.add("on-touch-device")}),{passive:!0}),document.addEventListener("scroll",(function(){document.body.classList.contains("on-touch-device")&&l()<-120&&e(t,o)}));var l=function(){var e,t,o,n;function a(){e=null,n=0}return a(),function(){return t=window.scrollY,null!=e&&(n=t-e),e=t,clearTimeout(o),o=setTimeout(a,50),n}}()}}}}})),document.querySelectorAll(".wp-block-emma-dialog__close").forEach((e=>{var t="click";"form"===e.tagName.toLowerCase()&&(t="submit"),e.addEventListener(t,(function(t){e.closest("dialog").close(),"#"===e.getAttribute("href")&&t.preventDefault()}))})),document.querySelectorAll(".prevent-dialog-auto-open").forEach((e=>{var t="click";"form"===e.tagName.toLowerCase()&&(t="submit"),e.addEventListener(t,(function(t){var o,n=e.closest("dialog");o=JSON.parse(n.dataset.options).openLimitId,localStorage.setItem(o+"-preventautoopen",1),"#"===e.getAttribute("href")&&t.preventDefault()}))}))}})();