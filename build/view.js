(()=>{function e(e,o){e.dataset.opened||(e.showModal(),e.dataset.opened=!0,o.openLimitId&&(localStorage.setItem(o.openCountId,parseInt(o.openCount)+1),localStorage.setItem(o.lastOpenedId,Date.now())))}window.onload=o=>{document.querySelectorAll(".wp-block-emma-dialog").forEach((o=>{var t=JSON.parse(o.dataset.options);if(""!==t.openLinkAddress&&document.querySelectorAll("[href='"+t.openLinkAddress+"']").forEach((e=>{e.addEventListener("click",(function(e){var n=window.innerWidth;"desktop"===t.openOn&&n<=600||"mobile"===t.openOn&&n>600||(e.preventDefault(),o.showModal(),o.dataset.opened=!0)}))})),t.openAutomatically&&!localStorage.getItem(t.openLimitId+"-preventautoopen")){var n=window.innerWidth;if(!("desktop"===t.openOn&&n<=600||"mobile"===t.openOn&&n>600)){var a=document.querySelector("body").classList.contains("logged-in");if(!(a&&"logged-out"===t.openUsers||!a&&"logged-in"===t.openUsers)){if(t.openLimit){t.lastOpenedId=t.openLimitId+"-lastopened",t.openCountId=t.openLimitId+"-opencount";var i=localStorage.getItem(t.lastOpenedId)||0,l=t.openLimitExpiration;if(console.log(i),console.log(Date.now()-86400*l),l>0&&Date.now()/1e3-86400*l>i&&localStorage.setItem(t.openCountId,0),t.openCount=localStorage.getItem(t.openCountId)||0,t.openCount>=t.openLimit)return}if("delay"===t.openAutomatically&&setTimeout((function(){e(o,t)}),1e3*t.openDelay),"exit"===t.openAutomatically){document.addEventListener("mouseout",(function(n){n.toElement||n.relatedTarget||e(o,t)})),document.addEventListener("touchstart",(function(){document.body.classList.add("on-touch-device")}),{passive:!0}),document.addEventListener("scroll",(function(){document.body.classList.contains("on-touch-device")&&d()<-120&&e(o,t)}));var d=function(){var e,o,t,n;function a(){e=null,n=0}return a(),function(){return o=window.scrollY,null!=e&&(n=o-e),e=o,clearTimeout(t),t=setTimeout(a,50),n}}()}}}}})),document.querySelectorAll(".wp-block-emma-dialog__close").forEach((e=>{var o="click";"form"===e.tagName.toLowerCase()&&(o="submit"),e.addEventListener(o,(function(o){e.closest("dialog").close(),"#"===e.getAttribute("href")&&o.preventDefault()}))})),document.querySelectorAll(".prevent-dialog-auto-open").forEach((e=>{var o="click";"form"===e.tagName.toLowerCase()&&(o="submit"),e.addEventListener(o,(function(o){var t,n=e.closest("dialog");t=JSON.parse(n.dataset.options).openLimitId,localStorage.setItem(t+"-preventautoopen",1),"#"===e.getAttribute("href")&&o.preventDefault()}))}))}})();